# Next.js è¿è¡ŒåŸç†è¯¦è§£

## ğŸŒŸ ä»€ä¹ˆæ˜¯Next.jsï¼Ÿ

Next.jsæ˜¯ä¸€ä¸ªåŸºäºReactçš„**å…¨æ ˆæ¡†æ¶**ï¼Œä¸æ˜¯Nuxt.jsï¼ˆVue.jsæ¡†æ¶ï¼‰ã€‚å®ƒæä¾›äº†è®¸å¤šå¼€ç®±å³ç”¨çš„åŠŸèƒ½ï¼Œè®©Reactå¼€å‘æ›´åŠ ç®€å•é«˜æ•ˆã€‚

## ğŸ”„ Next.js vs Nuxt.js å¯¹æ¯”

| ç‰¹æ€§ | Next.js | Nuxt.js |
|------|---------|---------|
| åŸºç¡€æ¡†æ¶ | React | Vue.js |
| è¯­è¨€ | JavaScript/TypeScript | JavaScript/TypeScript |
| è·¯ç”± | æ–‡ä»¶ç³»ç»Ÿè·¯ç”± | æ–‡ä»¶ç³»ç»Ÿè·¯ç”± |
| æ¸²æŸ“æ¨¡å¼ | SSG/SSR/CSR | SSG/SSR/CSR |
| ç”Ÿæ€ç³»ç»Ÿ | Reactç”Ÿæ€ | Vueç”Ÿæ€ |

## ğŸ—ï¸ Next.js æ¶æ„åŸç†

### 1. æ–‡ä»¶ç³»ç»Ÿè·¯ç”±
Next.jsä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿä½œä¸ºè·¯ç”±ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®è·¯ç”±ï¼š

```
app/
â”œâ”€â”€ page.tsx                    # / (é¦–é¡µ)
â”œâ”€â”€ about/
â”‚   â””â”€â”€ page.tsx               # /about
â”œâ”€â”€ articles/
â”‚   â”œâ”€â”€ page.tsx               # /articles
â”‚   â””â”€â”€ [id]/
â”‚       â””â”€â”€ page.tsx           # /articles/123 (åŠ¨æ€è·¯ç”±)
â””â”€â”€ api/
    â””â”€â”€ contact/
        â””â”€â”€ route.ts           # /api/contact (APIè·¯ç”±)
```

### 2. æ¸²æŸ“æ¨¡å¼è¯¦è§£

#### SSG (Static Site Generation) - é™æ€ç«™ç‚¹ç”Ÿæˆ
```typescript
// æ„å»ºæ—¶ç”Ÿæˆé™æ€HTML
export default function Page({ data }) {
  return <div>{data.title}</div>
}

// æ„å»ºæ—¶è·å–æ•°æ®
export async function generateStaticParams() {
  return [{ id: '1' }, { id: '2' }]
}
```

**ä¼˜åŠ¿**:
- é¡µé¢åŠ è½½æå¿«
- SEOå‹å¥½
- æœåŠ¡å™¨å‹åŠ›å°
- å®‰å…¨æ€§é«˜

#### SSR (Server-Side Rendering) - æœåŠ¡ç«¯æ¸²æŸ“
```typescript
// æ¯æ¬¡è¯·æ±‚æ—¶åœ¨æœåŠ¡å™¨ç”ŸæˆHTML
export default function Page({ data }) {
  return <div>{data.title}</div>
}

// æœåŠ¡å™¨ç«¯è·å–æ•°æ®
export async function getServerSideProps() {
  const data = await fetch('https://api.example.com/data')
  return { props: { data } }
}
```

**ä¼˜åŠ¿**:
- é¦–å±åŠ è½½å¿«
- å®æ—¶æ•°æ®
- SEOå‹å¥½

#### CSR (Client-Side Rendering) - å®¢æˆ·ç«¯æ¸²æŸ“
```typescript
'use client' // æ ‡è®°ä¸ºå®¢æˆ·ç«¯ç»„ä»¶

import { useState, useEffect } from 'react'

export default function Page() {
  const [data, setData] = useState(null)
  
  useEffect(() => {
    fetch('/api/data').then(res => res.json()).then(setData)
  }, [])
  
  return <div>{data?.title}</div>
}
```

**ä¼˜åŠ¿**:
- äº¤äº’æ€§å¼º
- ç”¨æˆ·ä½“éªŒå¥½
- å‡å°‘æœåŠ¡å™¨è´Ÿè½½

## ğŸ”§ Next.js æ„å»ºè¿‡ç¨‹

### 1. å¼€å‘æ¨¡å¼ (npm run dev)
```bash
npm run dev
```

**æµç¨‹**:
1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
2. çƒ­é‡è½½ç›‘å¬æ–‡ä»¶å˜åŒ–
3. å®æ—¶ç¼–è¯‘TypeScript/JSX
4. è‡ªåŠ¨åˆ·æ–°æµè§ˆå™¨

### 2. ç”Ÿäº§æ„å»º (npm run build)
```bash
npm run build
```

**æµç¨‹**:
1. ç¼–è¯‘TypeScript â†’ JavaScript
2. ä¼˜åŒ–ä»£ç ï¼ˆå‹ç¼©ã€tree-shakingï¼‰
3. ç”Ÿæˆé™æ€æ–‡ä»¶
4. åˆ›å»ºæœåŠ¡å™¨ç«¯ä»£ç 
5. ç”Ÿæˆmanifestæ–‡ä»¶

### 3. ç”Ÿäº§å¯åŠ¨ (npm start)
```bash
npm start
```

**æµç¨‹**:
1. å¯åŠ¨Node.jsæœåŠ¡å™¨
2. æä¾›é™æ€æ–‡ä»¶æœåŠ¡
3. å¤„ç†APIè¯·æ±‚
4. æœåŠ¡ç«¯æ¸²æŸ“åŠ¨æ€é¡µé¢

## ğŸ“ é¡¹ç›®æ–‡ä»¶ç»“æ„è§£æ

```
cms/
â”œâ”€â”€ app/                        # App Router (Next.js 13+)
â”‚   â”œâ”€â”€ globals.css            # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ layout.tsx             # æ ¹å¸ƒå±€
â”‚   â”œâ”€â”€ page.tsx               # é¦–é¡µ
â”‚   â”œâ”€â”€ loading.tsx            # åŠ è½½é¡µé¢
â”‚   â”œâ”€â”€ error.tsx              # é”™è¯¯é¡µé¢
â”‚   â””â”€â”€ not-found.tsx          # 404é¡µé¢
â”œâ”€â”€ components/                # Reactç»„ä»¶
â”‚   â”œâ”€â”€ ui/                    # åŸºç¡€UIç»„ä»¶
â”‚   â””â”€â”€ features/              # åŠŸèƒ½ç»„ä»¶
â”œâ”€â”€ lib/                       # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ utils.ts              # é€šç”¨å·¥å…·
â”‚   â””â”€â”€ api.ts                # APIå°è£…
â”œâ”€â”€ public/                    # é™æ€èµ„æº
â”‚   â”œâ”€â”€ images/               # å›¾ç‰‡
â”‚   â””â”€â”€ icons/                # å›¾æ ‡
â”œâ”€â”€ styles/                    # æ ·å¼æ–‡ä»¶
â”œâ”€â”€ types/                     # TypeScriptç±»å‹å®šä¹‰
â””â”€â”€ é…ç½®æ–‡ä»¶
    â”œâ”€â”€ next.config.js        # Next.jsé…ç½®
    â”œâ”€â”€ tailwind.config.js    # Tailwind CSSé…ç½®
    â”œâ”€â”€ tsconfig.json         # TypeScripté…ç½®
    â””â”€â”€ package.json          # ä¾èµ–é…ç½®
```

## ğŸ¯ æ•°æ®è·å–æ¨¡å¼

### 1. é™æ€æ•°æ®è·å–
```typescript
// æ„å»ºæ—¶è·å–æ•°æ®
async function getData() {
  const res = await fetch('https://api.example.com/posts')
  return res.json()
}

export default async function Page() {
  const data = await getData()
  return <div>{data.title}</div>
}
```

### 2. åŠ¨æ€æ•°æ®è·å–
```typescript
'use client'

import { useState, useEffect } from 'react'

export default function Page() {
  const [data, setData] = useState(null)
  
  useEffect(() => {
    async function fetchData() {
      const res = await fetch('/api/data')
      const result = await res.json()
      setData(result)
    }
    fetchData()
  }, [])
  
  return <div>{data?.title}</div>
}
```

### 3. æœåŠ¡å™¨ç»„ä»¶ vs å®¢æˆ·ç«¯ç»„ä»¶

#### æœåŠ¡å™¨ç»„ä»¶ (é»˜è®¤)
```typescript
// åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œ
export default function ServerComponent() {
  return <div>æˆ‘åœ¨æœåŠ¡å™¨ä¸Šæ¸²æŸ“</div>
}
```

#### å®¢æˆ·ç«¯ç»„ä»¶
```typescript
'use client' // å¿…é¡»å£°æ˜

import { useState } from 'react'

export default function ClientComponent() {
  const [count, setCount] = useState(0)
  return (
    <button onClick={() => setCount(count + 1)}>
      ç‚¹å‡»: {count}
    </button>
  )
}
```

## ğŸš€ æ€§èƒ½ä¼˜åŒ–åŸç†

### 1. ä»£ç åˆ†å‰²
Next.jsè‡ªåŠ¨è¿›è¡Œä»£ç åˆ†å‰²ï¼Œæ¯ä¸ªé¡µé¢åªåŠ è½½éœ€è¦çš„ä»£ç ï¼š

```typescript
// åŠ¨æ€å¯¼å…¥
const DynamicComponent = dynamic(() => import('./HeavyComponent'), {
  loading: () => <p>Loading...</p>,
})
```

### 2. å›¾ç‰‡ä¼˜åŒ–
```typescript
import Image from 'next/image'

export default function Page() {
  return (
    <Image
      src="/hero.jpg"
      alt="Hero"
      width={800}
      height={600}
      priority // ä¼˜å…ˆåŠ è½½
    />
  )
}
```

### 3. å­—ä½“ä¼˜åŒ–
```typescript
import { Inter } from 'next/font/google'

const inter = Inter({ subsets: ['latin'] })

export default function Layout({ children }) {
  return (
    <html className={inter.className}>
      <body>{children}</body>
    </html>
  )
}
```

## ğŸŒ éƒ¨ç½²åŸç†

### 1. é™æ€éƒ¨ç½²
```bash
# ç”Ÿæˆé™æ€æ–‡ä»¶
npm run build

# éƒ¨ç½²åˆ°CDN
# æ–‡ä»¶ç»“æ„ï¼š
out/
â”œâ”€â”€ index.html
â”œâ”€â”€ about.html
â”œâ”€â”€ _next/
â”‚   â”œâ”€â”€ static/
â”‚   â””â”€â”€ chunks/
â””â”€â”€ assets/
```

### 2. æœåŠ¡å™¨éƒ¨ç½²
```bash
# æ„å»ºåº”ç”¨
npm run build

# å¯åŠ¨æœåŠ¡å™¨
npm start

# æœåŠ¡å™¨æä¾›ï¼š
# - é™æ€æ–‡ä»¶æœåŠ¡
# - APIè·¯ç”±å¤„ç†
# - æœåŠ¡ç«¯æ¸²æŸ“
```

### 3. è¾¹ç¼˜éƒ¨ç½² (Vercel)
```bash
# éƒ¨ç½²åˆ°è¾¹ç¼˜ç½‘ç»œ
vercel --prod

# ç‰¹æ€§ï¼š
# - å…¨çƒCDN
# - è¾¹ç¼˜è®¡ç®—
# - è‡ªåŠ¨æ‰©å±•
```

## ğŸ“Š æ„å»ºè¾“å‡ºåˆ†æ

è¿è¡Œ `npm run build` åçš„è¾“å‡ºï¼š

```
Route (app)                    Size     First Load JS
â”Œ â—‹ /                         1.2 kB        85.3 kB
â”œ â—‹ /about                    892 B         85.0 kB
â”œ â—‹ /articles                 1.1 kB        85.2 kB
â”” â—‹ /contact                  1.3 kB        85.4 kB

â—‹ (Static)  automatically rendered as static HTML
â— (SSG)     automatically generated as static HTML + JSON
Î» (Server)  server-side renders at runtime
```

**ç¬¦å·è¯´æ˜**:
- `â—‹` é™æ€é¡µé¢
- `â—` é™æ€ç”Ÿæˆ
- `Î»` æœåŠ¡ç«¯æ¸²æŸ“

## ğŸ”„ çƒ­é‡è½½åŸç†

å¼€å‘æ¨¡å¼ä¸‹çš„çƒ­é‡è½½ï¼š

1. **æ–‡ä»¶ç›‘å¬**: ç›‘å¬æ–‡ä»¶ç³»ç»Ÿå˜åŒ–
2. **å¢é‡ç¼–è¯‘**: åªç¼–è¯‘å˜åŒ–çš„æ–‡ä»¶
3. **çƒ­æ›´æ–°**: åœ¨ä¸åˆ·æ–°é¡µé¢çš„æƒ…å†µä¸‹æ›´æ–°ä»£ç 
4. **çŠ¶æ€ä¿æŒ**: ä¿æŒReactç»„ä»¶çŠ¶æ€

## ğŸ¨ CSSå¤„ç†åŸç†

### 1. CSS Modules
```typescript
// styles/Home.module.css
.container {
  padding: 20px;
}

// ç»„ä»¶ä¸­ä½¿ç”¨
import styles from './Home.module.css'

export default function Home() {
  return <div className={styles.container}>å†…å®¹</div>
}
```

### 2. Tailwind CSS
```typescript
// ç›´æ¥ä½¿ç”¨å·¥å…·ç±»
export default function Button() {
  return (
    <button className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
      æŒ‰é’®
    </button>
  )
}
```

## ğŸ› ï¸ ä¸­é—´ä»¶ç³»ç»Ÿ

```typescript
// middleware.ts
import { NextResponse } from 'next/server'
import type { NextRequest } from 'next/server'

export function middleware(request: NextRequest) {
  // è¯·æ±‚æ‹¦æˆª
  if (request.nextUrl.pathname.startsWith('/admin')) {
    // æƒé™æ£€æŸ¥
    return NextResponse.redirect(new URL('/login', request.url))
  }
  
  return NextResponse.next()
}

export const config = {
  matcher: '/admin/:path*'
}
```

## ğŸ“ˆ ç›‘æ§å’Œè°ƒè¯•

### 1. æ€§èƒ½ç›‘æ§
```typescript
// æ€§èƒ½æŒ‡æ ‡æ”¶é›†
export function reportWebVitals(metric) {
  console.log(metric)
}
```

### 2. é”™è¯¯è¾¹ç•Œ
```typescript
'use client'

import { ErrorBoundary } from 'react-error-boundary'

function ErrorFallback({ error, resetErrorBoundary }) {
  return (
    <div role="alert">
      <h2>å‡ºé”™äº†:</h2>
      <pre>{error.message}</pre>
      <button onClick={resetErrorBoundary}>é‡è¯•</button>
    </div>
  )
}

export default function App() {
  return (
    <ErrorBoundary FallbackComponent={ErrorFallback}>
      <MyComponent />
    </ErrorBoundary>
  )
}
```

---

è¿™å°±æ˜¯Next.jsçš„æ ¸å¿ƒè¿è¡ŒåŸç†ï¼å®ƒé€šè¿‡æ–‡ä»¶ç³»ç»Ÿè·¯ç”±ã€å¤šç§æ¸²æŸ“æ¨¡å¼ã€è‡ªåŠ¨ä¼˜åŒ–ç­‰ç‰¹æ€§ï¼Œä¸ºReactåº”ç”¨æä¾›äº†å¼ºå¤§çš„å…¨æ ˆå¼€å‘èƒ½åŠ›ã€‚